import urllib, csv, os, datetime, urllib.request, re, sys
import time
import requests
from bs4 import BeautifulSoup
import mysql.connector
import json

while True:


    conn = mysql.connector.connect(host="dublinbikesdata.cmgmbuuwvwd0.eu-west-1.rds.amazonaws.com",user="EnxiJessieMarian",passwd="SoftwareEngineering2019",database="DublinBikesData")
    mycursor = conn.cursor()
    
    
    
    url = 'http://api.openweathermap.org/data/2.5/weather?appid=ae679d7b6212a1a3daf681d0d843aa83&q=Dublin'
    the_page = requests.get(url).json()
#     print(the_page)
#     print(the_page['main']['temp'])
    
    
    
    sql = "INSERT INTO weather (temperature, cloud, humidity, wind_direction, wind_speed) VALUES (%s, %s, %s, %s, %s)"
    val = (the_page['main']['temp'], the_page['clouds']['all'], the_page['main']['humidity'], the_page['wind']['deg'], the_page['wind']['speed'] )
    mycursor.execute(sql, val)
    
    
    conn.commit()
    conn.close()
    
    
    time.sleep(3600)
